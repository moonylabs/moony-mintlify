import React, { useEffect } from 'react';

export default function DisclaimerModal() {
  useEffect(() => {
    if (typeof window === 'undefined' || typeof document === 'undefined') return;
    
    // Check if modal already exists
    if (document.getElementById('moony-disclaimer-modal')) {
      return;
    }
    
    function checkDark() {
      return document.documentElement.classList.contains('dark') || 
             window.matchMedia('(prefers-color-scheme: dark)').matches;
    }
    
    function createModal() {
      // Double check modal doesn't exist
      if (document.getElementById('moony-disclaimer-modal')) {
        return;
      }
      
      const isDark = checkDark();
      const bg = isDark ? '#1e293b' : 'white';
      const text = isDark ? '#e2e8f0' : '#1e293b';
      const textSec = isDark ? '#cbd5e1' : '#475569';
      const overlay = isDark ? 'rgba(0, 0, 0, 0.7)' : 'rgba(0, 0, 0, 0.5)';
      const shadow = isDark 
        ? '0 20px 25px -5px rgba(0, 0, 0, 0.4), 0 10px 10px -5px rgba(0, 0, 0, 0.2)'
        : '0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04)';
      
      const modal = document.createElement('div');
      modal.id = 'moony-disclaimer-modal';
      modal.style.cssText = `position: fixed; top: 0; left: 0; right: 0; bottom: 0; z-index: 99999; background-color: ${overlay}; display: flex; align-items: center; justify-content: center; padding: 1rem;`;
      
      modal.innerHTML = `
        <div style="background-color: ${bg}; border-radius: 1rem; padding: 2rem; max-width: 600px; width: 100%; max-height: 90vh; overflow-y: auto; box-shadow: ${shadow}; position: relative; z-index: 100000;">
          <h2 style="margin-top: 0; margin-bottom: 1.5rem; color: ${text}; font-size: 1.5rem; font-weight: 600; text-align: justify;">
            Before Proceeding, Please Review
          </h2>
          
          <div style="margin-bottom: 1.5rem;">
            <h3 style="margin-top: 0; margin-bottom: 0.75rem; color: #502792; font-size: 1.125rem; font-weight: 600; text-align: justify;">
              Informational Use Only
            </h3>
            <p style="margin-bottom: 1rem; color: ${textSec}; line-height: 1.6; text-align: justify;">
              This documentation is provided solely for informational and educational purposes and does not constitute financial, legal, tax, or investment advice. Nothing herein should be interpreted as an offer, solicitation, recommendation, or endorsement to acquire, hold, use, or dispose of any digital asset.
            </p>
          </div>

          <div style="margin-bottom: 1.5rem;">
            <h3 style="margin-top: 0; margin-bottom: 0.75rem; color: #502792; font-size: 1.125rem; font-weight: 600; text-align: justify;">
              Protocol Characteristics
            </h3>
            <p style="margin-bottom: 1rem; color: ${textSec}; line-height: 1.6; text-align: justify;">
              Moony is a decentralized protocol governed by an immutable smart contract deployed on the Solana blockchain. Once deployed onchain, the protocol operates autonomously according to its code and is not controlled or managed by Moony Labs or any other party. Its behavior and outcomes depend on technical, network, and external conditions inherent to decentralized systems.
            </p>
          </div>

          <div style="margin-bottom: 1.5rem;">
            <h3 style="margin-top: 0; margin-bottom: 0.75rem; color: #502792; font-size: 1.125rem; font-weight: 600; text-align: justify;">
              Risks and No Warranties
            </h3>
            <p style="margin-bottom: 1rem; color: ${textSec}; line-height: 1.6; text-align: justify;">
              Interaction with blockchain technology involves inherent risks, including potential loss of value, smart contract vulnerabilities, network failures, and irreversible transactions.
            </p>
            <p style="margin-bottom: 1rem; color: ${textSec}; line-height: 1.6; text-align: justify;">
              The protocol and this documentation are provided "as is," without warranties of any kind. To the maximum extent permitted by law, Moony Labs LLC disclaims all liability arising from use of the protocol or reliance on this documentation.
            </p>
            <p style="margin-bottom: 0; color: ${textSec}; line-height: 1.6; text-align: justify; font-weight: 500;">
              By continuing, you acknowledge and accept these risks.
            </p>
          </div>

          <div style="margin-top: 2rem; display: flex; flex-direction: column; gap: 1rem;">
            <a href="/disclaimer" style="color: #502792; text-decoration: none; font-size: 0.9375rem; font-weight: 500; padding: 0.5rem 0; transition: color 0.2s ease, text-decoration 0.2s ease; align-self: flex-start;">
              View Full Disclaimer
            </a>
            <button id="disclaimer-understand-btn" style="background-color: #502792; color: white; border: none; border-radius: 0.5rem; padding: 0.75rem 1.5rem; font-size: 1rem; font-weight: 600; cursor: pointer; transition: background-color 0.2s ease; align-self: flex-start;">
              I Understand
            </button>
          </div>
        </div>
      `;
      
      if (document.body) {
        document.body.appendChild(modal);
        
        const btn = modal.querySelector('#disclaimer-understand-btn');
        if (btn) {
          btn.addEventListener('click', function() {
            modal.remove();
          });
          
          btn.addEventListener('mouseenter', function() {
            this.style.backgroundColor = '#3d1f6f';
          });
          btn.addEventListener('mouseleave', function() {
            this.style.backgroundColor = '#502792';
          });
        }
        
        const link = modal.querySelector('a[href="/disclaimer"]');
        if (link) {
          link.addEventListener('mouseenter', function() {
            this.style.color = '#3d1f6f';
            this.style.textDecoration = 'underline';
          });
          link.addEventListener('mouseleave', function() {
            this.style.color = '#502792';
            this.style.textDecoration = 'none';
          });
        }
      }
    }
    
    // Try multiple approaches to ensure it runs
    if (document.body) {
      createModal();
    } else if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', createModal);
    } else {
      setTimeout(createModal, 100);
    }
    
    // Also try after a short delay as fallback
    const timeoutId = setTimeout(() => {
      if (!document.getElementById('moony-disclaimer-modal') && document.body) {
        createModal();
      }
    }, 500);
    
    return () => {
      clearTimeout(timeoutId);
      const modal = document.getElementById('moony-disclaimer-modal');
      if (modal) {
        modal.remove();
      }
    };
  }, []);

  // Return a hidden element so React knows to render this component
  return <div style={{ display: 'none' }} data-modal-injector="true" />;
}
      <div
        style={{
          backgroundColor: bg,
          borderRadius: '1rem',
          padding: '2rem',
          maxWidth: '600px',
          width: '100%',
          maxHeight: '90vh',
          overflowY: 'auto',
          boxShadow: shadow,
          position: 'relative',
          zIndex: 100000
        }}
      >
        <h2 style={{ marginTop: 0, marginBottom: '1.5rem', color: text, fontSize: '1.5rem', fontWeight: 600, textAlign: 'justify' }}>
          Before Proceeding, Please Review
        </h2>
        
        <div style={{ marginBottom: '1.5rem' }}>
          <h3 style={{ marginTop: 0, marginBottom: '0.75rem', color: '#502792', fontSize: '1.125rem', fontWeight: 600, textAlign: 'justify' }}>
            Informational Use Only
          </h3>
          <p style={{ marginBottom: '1rem', color: textSec, lineHeight: '1.6', textAlign: 'justify' }}>
            This documentation is provided solely for informational and educational purposes and does not constitute financial, legal, tax, or investment advice. Nothing herein should be interpreted as an offer, solicitation, recommendation, or endorsement to acquire, hold, use, or dispose of any digital asset.
          </p>
        </div>

        <div style={{ marginBottom: '1.5rem' }}>
          <h3 style={{ marginTop: 0, marginBottom: '0.75rem', color: '#502792', fontSize: '1.125rem', fontWeight: 600, textAlign: 'justify' }}>
            Protocol Characteristics
          </h3>
          <p style={{ marginBottom: '1rem', color: textSec, lineHeight: '1.6', textAlign: 'justify' }}>
            Moony is a decentralized protocol governed by an immutable smart contract deployed on the Solana blockchain. Once deployed onchain, the protocol operates autonomously according to its code and is not controlled or managed by Moony Labs or any other party. Its behavior and outcomes depend on technical, network, and external conditions inherent to decentralized systems.
          </p>
        </div>

        <div style={{ marginBottom: '1.5rem' }}>
          <h3 style={{ marginTop: 0, marginBottom: '0.75rem', color: '#502792', fontSize: '1.125rem', fontWeight: 600, textAlign: 'justify' }}>
            Risks and No Warranties
          </h3>
          <p style={{ marginBottom: '1rem', color: textSec, lineHeight: '1.6', textAlign: 'justify' }}>
            Interaction with blockchain technology involves inherent risks, including potential loss of value, smart contract vulnerabilities, network failures, and irreversible transactions.
          </p>
          <p style={{ marginBottom: '1rem', color: textSec, lineHeight: '1.6', textAlign: 'justify' }}>
            The protocol and this documentation are provided "as is," without warranties of any kind. To the maximum extent permitted by law, Moony Labs LLC disclaims all liability arising from use of the protocol or reliance on this documentation.
          </p>
          <p style={{ marginBottom: 0, color: textSec, lineHeight: '1.6', textAlign: 'justify', fontWeight: 500 }}>
            By continuing, you acknowledge and accept these risks.
          </p>
        </div>

        <div style={{ marginTop: '2rem', display: 'flex', flexDirection: 'column', gap: '1rem' }}>
          <a
            href="/disclaimer"
            style={{
              color: '#502792',
              textDecoration: 'none',
              fontSize: '0.9375rem',
              fontWeight: 500,
              padding: '0.5rem 0',
              transition: 'color 0.2s ease, text-decoration 0.2s ease',
              alignSelf: 'flex-start'
            }}
            onMouseEnter={(e) => {
              e.target.style.color = '#3d1f6f';
              e.target.style.textDecoration = 'underline';
            }}
            onMouseLeave={(e) => {
              e.target.style.color = '#502792';
              e.target.style.textDecoration = 'none';
            }}
          >
            View Full Disclaimer
          </a>
          <button
            onClick={() => setShow(false)}
            style={{
              backgroundColor: '#502792',
              color: 'white',
              border: 'none',
              borderRadius: '0.5rem',
              padding: '0.75rem 1.5rem',
              fontSize: '1rem',
              fontWeight: 600,
              cursor: 'pointer',
              transition: 'background-color 0.2s ease',
              alignSelf: 'flex-start'
            }}
            onMouseEnter={(e) => e.target.style.backgroundColor = '#3d1f6f'}
            onMouseLeave={(e) => e.target.style.backgroundColor = '#502792'}
          >
            I Understand
          </button>
        </div>
      </div>
    </div>
  );
}
